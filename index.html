<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>EventHubX - Dashboard</title>
    <base href="/">
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "primary-hover": "#0f6ac6",
                        "background-light": "#f6f7f8",
                        "background-dark": "#0f172a",
                        "surface-dark": "#1e293b",
                        "surface-hover": "#334155",
                        "border-dark": "#334155",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"],
                        "sans": ["Inter", "sans-serif"],
                    },
                    borderRadius: {
                        "DEFAULT": "0.375rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>

    <link rel="stylesheet" href="/css/styles.css" />
    <!-- SheetJS for Excel Export -->
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>

    <!-- Supabase JS -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <!-- Supabase Client Setup -->
    <script src="/js/supabaseClient.js"></script>
</head>

<body class="bg-background-dark text-slate-100 font-display min-h-screen flex overflow-hidden">

    <!-- ── Login Overlay (DISABLED - Login now happens on landing page only) ── -->
    <div id="login-overlay" class="hidden fixed inset-0 z-[70] items-center justify-center bg-background-dark"
        style="background: radial-gradient(ellipse at 60% 20%, rgba(99,102,241,0.18) 0%, transparent 60%), radial-gradient(ellipse at 20% 80%, rgba(6,182,212,0.12) 0%, transparent 60%), #0b0f1a;">
        <!-- NOTE: This login overlay is kept for fallback purposes but is hidden by default -->
        <div class="w-full max-w-sm px-4">
            <!-- Logo / Brand -->
            <div class="flex flex-col items-center mb-8">
                <div
                    class="size-14 rounded-2xl bg-gradient-to-br from-primary to-indigo-600 flex items-center justify-center shadow-lg shadow-primary/30 mb-4">
                    <span class="material-symbols-outlined text-white text-[32px]">hub</span>
                </div>
                <h1 class="text-2xl font-bold text-white tracking-tight">EventHubX</h1>
                <p class="text-slate-400 text-sm mt-1">Sign in to your workspace</p>
            </div>
            <!-- Card -->
            <div class="bg-surface-dark border border-border-dark/60 rounded-2xl p-6 shadow-2xl">
                <form id="login-form" onsubmit="handleLogin(event)" class="space-y-4">
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Username</label>
                        <input id="login-username" type="text" autocomplete="username" placeholder="e.g. zee"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/40 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Password</label>
                        <div class="relative">
                            <input id="login-password" type="password" autocomplete="current-password"
                                placeholder="••••••••"
                                class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/40 rounded-lg px-3 py-2.5 pr-10 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                            <button type="button" onclick="togglePwVis()"
                                class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-300 transition-colors">
                                <span id="pw-eye" class="material-symbols-outlined text-[18px]">visibility</span>
                            </button>
                        </div>
                    </div>
                    <p id="login-error" class="text-xs text-red-400 hidden"></p>
                    <button type="submit" id="login-btn"
                        class="w-full bg-primary hover:bg-primary-hover text-white font-semibold py-2.5 rounded-lg text-sm transition-colors flex items-center justify-center gap-2">
                        <span id="login-btn-text">Sign In</span>
                        <span id="login-spinner"
                            class="hidden material-symbols-outlined text-[16px] animate-spin">progress_activity</span>
                    </button>
                </form>
            </div>
            <p class="text-center text-xs text-slate-600 mt-4">EventHubX · Digital Operations Team</p>
        </div>
    </div>

    <aside
        class="w-64 flex-shrink-0 border-r border-white/10 bg-[#0b0f1a] flex flex-col h-screen fixed left-0 top-0 z-50">
        <div class="h-16 flex items-center px-6 border-b border-white/10">
            <div class="flex items-center gap-3">
                <div
                    class="size-9 rounded-xl bg-primary flex items-center justify-center text-white shadow-lg shadow-primary/20">
                    <span class="material-symbols-outlined text-[22px]">hub</span>
                </div>
                <h1 class="text-white text-xl font-bold tracking-tight">EventHubX</h1>
            </div>
        </div>

        <nav class="flex-1 py-10 px-3 space-y-2 overflow-y-auto custom-scrollbar">
            <a id="nav-dashboard" onclick="switchView('dashboard')"
                class="flex items-center gap-3 px-3 py-3 rounded-xl bg-primary/10 text-primary border border-primary/20 group transition-all duration-300 cursor-pointer">
                <span class="material-symbols-outlined">dashboard</span>
                <span class="text-sm font-bold uppercase tracking-widest">Dashboard</span>
            </a>
            <a id="nav-events" onclick="switchView('events')"
                class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                <span class="material-symbols-outlined">event</span>
                <span class="text-sm font-bold uppercase tracking-widest">Events</span>
            </a>
            <a id="nav-event-dashboard" onclick="switchView('event-dashboard')"
                class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                <span class="material-symbols-outlined">analytics</span>
                <span class="text-sm font-bold uppercase tracking-widest">Event Dashboard</span>
            </a>
            <a id="nav-exhibitors" onclick="switchView('exhibitors')"
                class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                <span class="material-symbols-outlined">storefront</span>
                <span class="text-sm font-bold uppercase tracking-widest">Exhibitors</span>
            </a>
            <a id="nav-people" onclick="switchView('people')"
                class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                <span class="material-symbols-outlined">group</span>
                <span class="text-sm font-bold uppercase tracking-widest">People</span>
            </a>
            <a id="nav-speakers" onclick="switchView('speakers')"
                class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                <span class="material-symbols-outlined">podium</span>
                <span class="text-sm font-bold uppercase tracking-widest">Speakers</span>
            </a>
            <a id="nav-sessions" onclick="switchView('sessions')"
                class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                <span class="material-symbols-outlined">calendar_today</span>
                <span class="text-sm font-bold uppercase tracking-widest">Sessions</span>
            </a>
            <a id="nav-sponsors" onclick="switchView('sponsors')"
                class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                <span class="material-symbols-outlined">handshake</span>
                <span class="text-sm font-bold uppercase tracking-widest">Sponsors</span>
            </a>

            <div class="pt-4 mt-4 border-t border-white/10 space-y-2">
                <p class="px-3 text-[10px] font-black text-slate-600 uppercase tracking-[0.2em] mb-2">System</p>
                <a id="nav-settings" onclick="openSettings()"
                    class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                    <span class="material-symbols-outlined">settings</span>
                    <span class="text-sm font-bold uppercase tracking-widest">Settings</span>
                </a>
                <a id="nav-claude" onclick="openChatPanel()"
                    class="flex items-center gap-3 px-3 py-3 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 group transition-all duration-300 cursor-pointer">
                    <span class="material-symbols-outlined">smart_toy</span>
                    <span class="text-sm font-bold uppercase tracking-widest">AI Assistant</span>
                </a>
            </div>
        </nav>

        <div class="p-4 border-t border-white/5">
            <button id="sidebar-user-btn" onclick="toggleUserMenu()"
                class="w-full flex items-center gap-3 px-3 py-3 rounded-2xl bg-slate-800/50 hover:bg-slate-700/50 backdrop-blur-sm transition-all text-left group border border-white/5">
                <div id="sidebar-avatar"
                    class="size-10 rounded-full bg-gradient-to-br from-primary to-indigo-600 flex items-center justify-center text-white text-sm font-bold shadow-lg shadow-primary/20 shrink-0">
                    ZP
                </div>
                <div class="flex-1 min-w-0">
                    <p id="sidebar-name" class="text-sm font-semibold text-white truncate">Zvonimir Petrovic</p>
                    <p id="sidebar-role" class="text-xs text-slate-400 truncate">Digital Ops Manager</p>
                </div>
                <span
                    class="material-symbols-outlined text-slate-500 group-hover:text-white transition-colors">expand_more</span>
            </button>
            <!-- User menu popover -->
            <div id="user-menu"
                class="hidden absolute bottom-20 left-4 w-64 bg-slate-900/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl overflow-hidden z-50">
                <!-- Profile header -->
                <div class="flex items-center gap-3 p-4 border-b border-white/10">
                    <div id="menu-avatar"
                        class="size-10 rounded-full bg-gradient-to-br from-primary to-indigo-600 flex items-center justify-center text-white text-xs font-bold shrink-0 shadow-lg">
                        ZP
                    </div>
                    <div class="flex-1 min-w-0">
                        <p id="user-menu-name" class="text-sm font-semibold text-white truncate">Zvonimir Petrovic</p>
                        <p id="user-menu-role" class="text-xs text-slate-400 truncate">Digital Ops Manager</p>
                    </div>
                </div>
                <!-- Menu items -->
                <div class="py-2">
                    <button onclick="openEditProfile()"
                        class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-slate-300 hover:bg-white/5 hover:text-white transition-all group">
                        <span
                            class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-primary transition-colors">manage_accounts</span>
                        <span class="font-medium">Edit Profile</span>
                    </button>
                    <button onclick="openChangePassword()"
                        class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-slate-300 hover:bg-white/5 hover:text-white transition-all group">
                        <span
                            class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-primary transition-colors">lock_reset</span>
                        <span class="font-medium">Change Password</span>
                    </button>
                    <div class="h-px bg-white/10 mx-4 my-2"></div>
                    <!-- Interface Selector -->
                    <div class="px-4 py-2">
                        <p class="text-[10px] text-slate-500 mb-2 font-bold uppercase tracking-wider">Interface Style
                        </p>
                        <div class="space-y-1.5">
                            <label class="flex items-center gap-2.5 cursor-pointer group">
                                <input type="radio" name="interface-menu" value="classic" onclick="switchToClassic()"
                                    class="w-4 h-4 text-primary bg-slate-800 border-white/20 focus:ring-2 focus:ring-primary/30">
                                <span
                                    class="text-xs text-slate-400 group-hover:text-white transition-colors font-medium">Classic</span>
                            </label>
                            <label class="flex items-center gap-2.5 cursor-pointer group">
                                <input type="radio" name="interface-menu" value="modern" onclick="switchToModern()"
                                    class="w-4 h-4 text-primary bg-slate-800 border-white/20 focus:ring-2 focus:ring-primary/30">
                                <span
                                    class="text-xs text-slate-400 group-hover:text-white transition-colors font-medium">Modern</span>
                            </label>
                        </div>
                    </div>
                    <div class="h-px bg-white/10 mx-4 my-2"></div>
                    <button onclick="switchAccount()"
                        class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-slate-300 hover:bg-white/5 hover:text-white transition-all group">
                        <span
                            class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-primary transition-colors">switch_account</span>
                        <span class="font-medium">Switch Account</span>
                    </button>
                    <button onclick="logout()"
                        class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-red-400 hover:bg-red-500/10 hover:text-red-300 transition-all group rounded-b-2xl">
                        <span
                            class="material-symbols-outlined text-[18px] group-hover:text-red-400 transition-colors">logout</span>
                        <span class="font-medium">Sign out</span>
                    </button>
                </div>
            </div>
        </div>
    </aside>

    <!-- ── Edit Profile Modal ───────────────────────────────────────────────── -->
    <div id="edit-profile-backdrop"
        class="fixed inset-0 z-[80] bg-black/60 backdrop-blur-sm hidden items-center justify-center"
        onclick="if(event.target===this) closeEditProfile()">
        <div id="edit-profile-modal"
            class="bg-[#161b2e] border border-border-dark/60 rounded-2xl w-full max-w-md shadow-2xl transform scale-95 opacity-0 transition-all duration-300 overflow-hidden">
            <!-- Header -->
            <div class="flex items-center justify-between px-6 pt-6 pb-4 border-b border-border-dark/40">
                <div class="flex items-center gap-3">
                    <div id="ep-avatar"
                        class="size-10 rounded-full bg-gradient-to-br from-violet-500 to-indigo-600 flex items-center justify-center text-white text-sm font-bold">
                        ZP
                    </div>
                    <div>
                        <h3 class="text-white font-semibold text-base">Edit Profile</h3>
                        <p id="ep-subtitle" class="text-slate-400 text-xs">Digital Ops Manager</p>
                    </div>
                </div>
                <button onclick="closeEditProfile()"
                    class="size-8 rounded-full bg-surface-dark/5 hover:bg-surface-dark/10 flex items-center justify-center text-slate-400 hover:text-white transition-colors">
                    <span class="material-symbols-outlined text-[18px]">close</span>
                </button>
            </div>
            <!-- Form -->
            <div class="px-6 py-5 space-y-4">
                <p class="text-[11px] text-slate-500 uppercase tracking-wider font-medium">Account Details</p>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Display Name</label>
                        <input id="ep-display-name" type="text" placeholder="Full name"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Nickname</label>
                        <input id="ep-short-name" type="text" placeholder="e.g. Zee"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                    </div>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Username</label>
                    <input id="ep-username" type="text" placeholder="login username"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Job Title</label>
                    <input id="ep-role" type="text" placeholder="e.g. Digital Ops Manager"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                </div>
                <div class="h-px bg-border-dark/40"></div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Current Password <span
                            class="text-red-400">*</span></label>
                    <input id="ep-current-password" type="password" placeholder="Required to save changes"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                    <p class="text-[11px] text-slate-600 mt-1">Confirm your password to apply changes.</p>
                </div>
                <p id="ep-error" class="text-xs text-red-400 hidden"></p>
                <p id="ep-success" class="text-xs text-emerald-400 hidden"></p>
            </div>
            <!-- Footer -->
            <div class="flex items-center justify-end gap-3 px-6 pb-6">
                <button onclick="closeEditProfile()"
                    class="px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors">Cancel</button>
                <button onclick="saveProfile()" id="ep-save-btn"
                    class="px-5 py-2 bg-primary hover:bg-primary-hover text-white text-sm font-semibold rounded-lg transition-colors flex items-center gap-2">
                    <span id="ep-save-text">Save Details</span>
                    <span id="ep-save-spinner"
                        class="hidden material-symbols-outlined text-[14px] animate-spin">progress_activity</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ── Change Password Modal ────────────────────────────────────────────── -->
    <div id="change-password-backdrop"
        class="fixed inset-0 z-[80] bg-black/60 backdrop-blur-sm hidden items-center justify-center"
        onclick="if(event.target===this) closeChangePassword()">
        <div id="change-password-modal"
            class="bg-[#161b2e] border border-border-dark/60 rounded-2xl w-full max-w-md shadow-2xl transform scale-95 opacity-0 transition-all duration-300 overflow-hidden">
            <div class="flex items-center justify-between px-6 pt-6 pb-4 border-b border-border-dark/40">
                <div class="flex items-center gap-3">
                    <div
                        class="size-10 rounded-full bg-gradient-to-br from-indigo-500 to-primary flex items-center justify-center text-white">
                        <span class="material-symbols-outlined">lock_reset</span>
                    </div>
                    <div>
                        <h3 class="text-white font-semibold text-base">Change Password</h3>
                        <p class="text-slate-400 text-xs">Update your account security</p>
                    </div>
                </div>
                <button onclick="closeChangePassword()"
                    class="size-8 rounded-full bg-surface-dark/5 hover:bg-surface-dark/10 flex items-center justify-center text-slate-400 hover:text-white transition-colors">
                    <span class="material-symbols-outlined text-[18px]">close</span>
                </button>
            </div>
            <div class="px-6 py-5 space-y-4">
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">New Password</label>
                    <div class="relative">
                        <input id="cp-new-password" type="password" placeholder="Min 8 characters recommended"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 pr-10 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                        <button type="button" onclick="toggleEpPw('cp-new-password','cp-eye-new')"
                            class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-300 transition-colors">
                            <span id="cp-eye-new" class="material-symbols-outlined text-[16px]">visibility</span>
                        </button>
                    </div>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Confirm New Password</label>
                    <div class="relative">
                        <input id="cp-confirm-password" type="password" placeholder="Repeat new password"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 pr-10 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                        <button type="button" onclick="toggleEpPw('cp-confirm-password','cp-eye-confirm')"
                            class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-300 transition-colors">
                            <span id="cp-eye-confirm" class="material-symbols-outlined text-[16px]">visibility</span>
                        </button>
                    </div>
                </div>
                <div class="h-px bg-border-dark/40"></div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Current Password <span
                            class="text-red-400">*</span></label>
                    <input id="cp-current-password" type="password" placeholder="Confirm identity to update"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                </div>
                <p id="cp-error" class="text-xs text-red-400 hidden"></p>
                <p id="cp-success" class="text-xs text-emerald-400 hidden"></p>
            </div>
            <div class="flex items-center justify-end gap-3 px-6 pb-6">
                <button onclick="closeChangePassword()"
                    class="px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors">Cancel</button>
                <button onclick="savePassword()" id="cp-save-btn"
                    class="px-5 py-2 bg-primary hover:bg-primary-hover text-white text-sm font-semibold rounded-lg transition-colors flex items-center gap-2">
                    <span id="cp-save-text">Update Password</span>
                    <span id="cp-save-spinner"
                        class="hidden material-symbols-outlined text-[14px] animate-spin">progress_activity</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ── New Event Modal ───────────────────────────────────────────────── -->
    <div id="new-event-backdrop"
        class="fixed inset-0 z-[80] bg-black/60 backdrop-blur-sm hidden items-center justify-center"
        onclick="if(event.target===this) closeNewEventModal()">
        <div id="new-event-modal"
            class="bg-[#161b2e] border border-border-dark/60 rounded-2xl w-full max-w-lg shadow-2xl transform scale-95 opacity-0 transition-all duration-300 overflow-hidden">
            <!-- Header -->
            <div class="flex items-center justify-between px-6 pt-6 pb-4 border-b border-border-dark/40">
                <div class="flex items-center gap-3">
                    <div
                        class="size-10 rounded-full bg-gradient-to-br from-indigo-500 to-primary flex items-center justify-center text-white text-sm font-bold">
                        <span class="material-symbols-outlined text-[20px]">event_note</span>
                    </div>
                    <div>
                        <h3 class="text-white font-semibold text-base">Create New Event</h3>
                        <p class="text-slate-400 text-xs">Initialize a new event in EventHubX</p>
                    </div>
                </div>
                <button onclick="closeNewEventModal()"
                    class="size-8 rounded-full bg-surface-dark/5 hover:bg-surface-dark/10 flex items-center justify-center text-slate-400 hover:text-white transition-colors">
                    <span class="material-symbols-outlined text-[18px]">close</span>
                </button>
            </div>
            <!-- Form -->
            <div class="px-6 py-5 space-y-4 max-h-[60vh] overflow-y-auto">
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Event Title <span
                            class="text-red-400">*</span></label>
                    <input id="ne-title" type="text" placeholder="e.g. Global Tech Summit 2026"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Community <span
                            class="text-red-400">*</span></label>
                    <select id="ne-community"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all">
                        <option value="">Select a community...</option>
                    </select>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Start Date</label>
                        <input id="ne-start" type="date"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all [color-scheme:dark]" />
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">End Date</label>
                        <input id="ne-end" type="date"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all [color-scheme:dark]" />
                    </div>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Location</label>
                    <input id="ne-location" type="text" placeholder="e.g. Dubai, UAE"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                </div>
                <p id="ne-error" class="text-xs text-red-400 hidden"></p>
            </div>
            <!-- Footer -->
            <div class="flex items-center justify-end gap-3 px-6 pb-6 pt-4 border-t border-border-dark/40">
                <button onclick="closeNewEventModal()"
                    class="px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors">Cancel</button>
                <button onclick="saveNewEvent()" id="ne-save-btn"
                    class="px-5 py-2 bg-primary hover:bg-primary-hover text-white text-sm font-semibold rounded-lg transition-colors flex items-center gap-2">
                    <span id="ne-save-text">Create Event</span>
                    <span id="ne-save-spinner"
                        class="hidden material-symbols-outlined text-[14px] animate-spin">progress_activity</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ── New Person Modal ───────────────────────────────────────────────── -->
    <div id="new-person-backdrop"
        class="fixed inset-0 z-[80] bg-black/60 backdrop-blur-sm hidden items-center justify-center"
        onclick="if(event.target===this) closeNewPersonModal()">
        <div id="new-person-modal"
            class="bg-[#161b2e] border border-border-dark/60 rounded-2xl w-full max-w-lg shadow-2xl transform scale-95 opacity-0 transition-all duration-300 overflow-hidden">
            <div class="flex items-center justify-between px-6 pt-6 pb-4 border-b border-border-dark/40">
                <div class="flex items-center gap-3">
                    <div
                        class="size-10 rounded-full bg-gradient-to-br from-indigo-500 to-primary flex items-center justify-center text-white text-sm font-bold">
                        <span class="material-symbols-outlined text-[20px]">person_add</span>
                    </div>
                    <div>
                        <h3 class="text-white font-semibold text-base">Create New Person</h3>
                        <p class="text-slate-400 text-xs">Add a new person to an event</p>
                    </div>
                </div>
                <button onclick="closeNewPersonModal()"
                    class="size-8 rounded-full bg-surface-dark/5 hover:bg-surface-dark/10 flex items-center justify-center text-slate-400 hover:text-white transition-colors"><span
                        class="material-symbols-outlined text-[18px]">close</span></button>
            </div>
            <div class="px-6 py-5 space-y-4 max-h-[60vh] overflow-y-auto">
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Target Event <span
                            class="text-red-400">*</span></label>
                    <select id="np-event"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all"></select>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">First Name <span
                                class="text-red-400">*</span></label>
                        <input id="np-first" type="text"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Last Name <span
                                class="text-red-400">*</span></label>
                        <input id="np-last" type="text"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                    </div>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Email Address</label>
                    <input id="np-email" type="email"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Job Title</label>
                        <input id="np-job" type="text"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Organization</label>
                        <input id="np-org" type="text"
                            class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                    </div>
                </div>
                <p id="np-error" class="text-xs text-red-400 hidden"></p>
            </div>
            <div class="flex items-center justify-end gap-3 px-6 pb-6 pt-4 border-t border-border-dark/40">
                <button onclick="closeNewPersonModal()"
                    class="px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors">Cancel</button>
                <button onclick="saveNewPerson()" id="np-save-btn"
                    class="px-5 py-2 bg-primary hover:bg-primary-hover text-white text-sm font-semibold rounded-lg transition-colors flex items-center gap-2">
                    <span id="np-save-text">Create Person</span>
                    <span id="np-save-spinner"
                        class="hidden material-symbols-outlined text-[14px] animate-spin">progress_activity</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ── New Exhibitor Modal ───────────────────────────────────────────────── -->
    <div id="new-exhibitor-backdrop"
        class="fixed inset-0 z-[80] bg-black/60 backdrop-blur-sm hidden items-center justify-center"
        onclick="if(event.target===this) closeNewExhibitorModal()">
        <div id="new-exhibitor-modal"
            class="bg-[#161b2e] border border-border-dark/60 rounded-2xl w-full max-w-lg shadow-2xl transform scale-95 opacity-0 transition-all duration-300 overflow-hidden">
            <div class="flex items-center justify-between px-6 pt-6 pb-4 border-b border-border-dark/40">
                <div class="flex items-center gap-3">
                    <div
                        class="size-10 rounded-full bg-gradient-to-br from-indigo-500 to-primary flex items-center justify-center text-white text-sm font-bold">
                        <span class="material-symbols-outlined text-[20px]">storefront</span>
                    </div>
                    <div>
                        <h3 class="text-white font-semibold text-base">Create New Exhibitor</h3>
                        <p class="text-slate-400 text-xs">Add a new exhibitor to an event</p>
                    </div>
                </div>
                <button onclick="closeNewExhibitorModal()"
                    class="size-8 rounded-full bg-surface-dark/5 hover:bg-surface-dark/10 flex items-center justify-center text-slate-400 hover:text-white transition-colors"><span
                        class="material-symbols-outlined text-[18px]">close</span></button>
            </div>
            <div class="px-6 py-5 space-y-4 max-h-[60vh] overflow-y-auto">
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Target Event <span
                            class="text-red-400">*</span></label>
                    <select id="nx-event"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all"></select>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Company Name <span
                            class="text-red-400">*</span></label>
                    <input id="nx-name" type="text"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-1.5">Description</label>
                    <textarea id="nx-desc" rows="3"
                        class="w-full bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all resize-none"></textarea>
                </div>
                <p id="nx-error" class="text-xs text-red-400 hidden"></p>
            </div>
            <div class="flex items-center justify-end gap-3 px-6 pb-6 pt-4 border-t border-border-dark/40">
                <button onclick="closeNewExhibitorModal()"
                    class="px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors">Cancel</button>
                <button onclick="saveNewExhibitor()" id="nx-save-btn"
                    class="px-5 py-2 bg-primary hover:bg-primary-hover text-white text-sm font-semibold rounded-lg transition-colors flex items-center gap-2">
                    <span id="nx-save-text">Create Exhibitor</span>
                    <span id="nx-save-spinner"
                        class="hidden material-symbols-outlined text-[14px] animate-spin">progress_activity</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ── Advanced Filter Modal ─────────────────────────────────────────── -->
    <div id="advanced-filter-backdrop"
        class="fixed inset-0 z-[80] bg-black/60 backdrop-blur-sm hidden items-center justify-center dialog-backdrop"
        onclick="if(event.target===this) closeAdvancedFilterModal()">
        <div id="advanced-filter-modal"
            class="bg-surface-dark border border-border-dark/60 rounded-2xl w-full max-w-lg shadow-2xl transform translate-x-full opacity-0 transition-all duration-300 overflow-hidden flex flex-col max-h-[90vh]">

            <div
                class="flex items-center justify-between px-6 pt-6 pb-4 border-b border-border-dark/40 bg-surface-dark shrink-0">
                <div class="flex items-center gap-3">
                    <div
                        class="size-10 rounded-full bg-surface-hover flex items-center justify-center text-primary text-sm font-bold shadow-inner border border-white/5">
                        <span class="material-symbols-outlined text-[20px]">tune</span>
                    </div>
                    <div>
                        <h3 class="text-white font-semibold text-base">Advanced Filters</h3>
                        <p class="text-slate-400 text-xs">Narrow down exactly what you need</p>
                    </div>
                </div>
                <button onclick="closeAdvancedFilterModal()"
                    class="size-8 rounded-full bg-surface-dark/5 hover:bg-surface-dark/10 flex items-center justify-center text-slate-400 hover:text-white transition-colors border border-white/5">
                    <span class="material-symbols-outlined text-[18px]">close</span>
                </button>
            </div>

            <div class="px-6 py-5 space-y-6 flex-1 overflow-y-auto custom-scrollbar">

                <div class="space-y-4 pb-5 border-b border-border-dark/30">
                    <h4 class="text-sm font-bold text-slate-300 uppercase tracking-widest flex items-center gap-2"><span
                            class="material-symbols-outlined text-[16px] text-primary">domain</span> Community Context
                    </h4>
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Specific Community</label>
                        <select id="adv-filter-community"
                            class="w-full bg-background-dark/50 hover:bg-background-dark focus:bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2.5 text-sm text-white outline-none transition-all cursor-pointer">
                            <option value="All">All Communities</option>
                        </select>
                    </div>
                </div>

                <div class="space-y-4">
                    <h4 class="text-sm font-bold text-slate-300 uppercase tracking-widest flex items-center gap-2"><span
                            class="material-symbols-outlined text-[16px] text-amber-500">monitoring</span> Minimum
                        Thresholds</h4>
                    <p class="text-xs text-slate-500 mb-3">Only show events that meet or exceed these numbers</p>

                    <div class="grid grid-cols-2 gap-x-4 gap-y-5">
                        <div class="relative group">
                            <label
                                class="block text-xs font-medium text-slate-400 mb-1.5 flex items-center gap-1.5"><span
                                    class="material-symbols-outlined text-[14px]">groups</span> Registrations</label>
                            <input id="adv-filter-reg" type="number" min="0" placeholder="0"
                                class="w-full bg-background-dark/50 hover:bg-background-dark focus:bg-background-dark border border-border-dark/60 focus:border-primary focus:ring-1 focus:ring-primary/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                        </div>
                        <div class="relative group">
                            <label
                                class="block text-xs font-medium text-slate-400 mb-1.5 flex items-center gap-1.5"><span
                                    class="material-symbols-outlined text-[14px] text-amber-500">storefront</span>
                                Exhibitors</label>
                            <input id="adv-filter-exh" type="number" min="0" placeholder="0"
                                class="w-full bg-background-dark/50 hover:bg-background-dark focus:bg-background-dark border border-border-dark/60 focus:border-amber-500 focus:ring-1 focus:ring-amber-500/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                        </div>

                        <div class="relative group">
                            <label
                                class="block text-xs font-medium text-slate-400 mb-1.5 flex items-center gap-1.5"><span
                                    class="material-symbols-outlined text-[14px] text-emerald-500">calendar_month</span>
                                Sessions</label>
                            <input id="adv-filter-sess" type="number" min="0" placeholder="0"
                                class="w-full bg-background-dark/50 hover:bg-background-dark focus:bg-background-dark border border-border-dark/60 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                        </div>
                        <div class="relative group">
                            <label
                                class="block text-xs font-medium text-slate-400 mb-1.5 flex items-center gap-1.5"><span
                                    class="material-symbols-outlined text-[14px] text-purple-400">record_voice_over</span>
                                Speakers</label>
                            <input id="adv-filter-spk" type="number" min="0" placeholder="0"
                                class="w-full bg-background-dark/50 hover:bg-background-dark focus:bg-background-dark border border-border-dark/60 focus:border-purple-500 focus:ring-1 focus:ring-purple-500/30 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600 outline-none transition-all" />
                        </div>
                    </div>
                </div>
            </div>

            <div
                class="flex items-center justify-between gap-3 px-6 py-4 border-t border-border-dark/40 bg-background-dark/30 shrink-0">
                <button onclick="clearAdvancedFilters()"
                    class="px-4 py-2 text-sm font-medium text-slate-400 hover:text-white hover:bg-surface-hover rounded-lg transition-colors flex items-center gap-2">
                    <span class="material-symbols-outlined text-[16px]">device_reset</span> Clear Filters
                </button>
                <div class="flex items-center gap-3">
                    <button onclick="closeAdvancedFilterModal()"
                        class="px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors">Cancel</button>
                    <button onclick="applyAdvancedFilters()"
                        class="px-6 py-2 bg-primary hover:bg-primary-hover text-white text-sm font-semibold rounded-lg shadow-lg shadow-primary/20 transition-all flex items-center gap-2 transform active:scale-95">
                        <span class="material-symbols-outlined text-[16px]">check</span> Apply Filters
                    </button>
                </div>
            </div>

        </div>
    </div>

    <!-- ── Activity Modal ─────────────────────────────────────────── -->
    <div id="activity-modal-backdrop"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[80] hidden items-center justify-center dialog-backdrop"
        onclick="if(event.target===this) closeActivityModal()">
        <div id="activity-modal"
            class="bg-surface-dark border border-border-dark/50 rounded-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto shadow-2xl transform scale-95 opacity-0 transition-all duration-300 flex flex-col">

            <div class="relative w-full h-32 bg-cover bg-center shrink-0 border-b border-border-dark/30"
                id="activity-modal-banner"
                style="background: linear-gradient(135deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.9)), url('data:image/svg+xml,%3Csvg width=%2260%22 height=%2260%22 viewBox=%220 0 60 60%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cg fill=%22none%22 fill-rule=%22evenodd%22%3E%3Cg fill=%22%239C92AC%22 fill-opacity=%220.05%22%3E%3Cpath d=%22M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');">
                <button onclick="closeActivityModal()"
                    class="absolute top-4 right-4 size-8 bg-black/50 hover:bg-black/80 rounded-full flex items-center justify-center text-white transition-colors">
                    <span class="material-symbols-outlined text-[18px]">close</span>
                </button>
                <div
                    class="absolute bottom-4 left-6 text-xs font-semibold px-3 py-1.5 rounded bg-primary/20 text-blue-300 border border-primary/30 backdrop-blur flex items-center gap-2">
                    <span class="material-symbols-outlined text-[14px]">history</span> Activity Logs
                </div>
            </div>

            <div class="p-6 flex-1 flex flex-col overflow-hidden">
                <div class="flex items-start gap-4 mb-6 shrink-0">
                    <div class="flex-1">
                        <h2 id="activity-modal-title" class="text-2xl font-bold text-white mb-2">System Activity</h2>
                        <div class="flex flex-wrap items-center gap-4">
                            <span class="text-sm text-slate-400 flex items-center gap-1"><span
                                    class="material-symbols-outlined text-[14px]">info</span> <span
                                    id="activity-modal-subtitle">Recent sync logs and system changes</span></span>
                        </div>
                    </div>
                </div>

                <div
                    class="bg-background-dark/30 rounded-lg border border-border-dark/20 flex-1 overflow-hidden flex flex-col min-h-0">
                    <div class="overflow-y-auto custom-scrollbar flex-1">
                        <table class="w-full text-left border-collapse">
                            <thead
                                class="sticky top-0 bg-[#151c2b]/95 backdrop-blur-md border-b border-border-dark/60 z-10 shadow-sm">
                                <tr class="text-[10px] text-slate-500 uppercase tracking-[0.2em] font-black">
                                    <th class="px-6 py-3 w-[200px]">User / System</th>
                                    <th class="px-6 py-3">Action</th>
                                    <th class="px-6 py-3 min-w-[120px]">Context</th>
                                    <th class="px-6 py-3 text-right">Time</th>
                                </tr>
                            </thead>
                            <tbody id="activity-tbody" class="divide-y divide-border-dark/20 text-sm">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <main class="flex-1 ml-64 flex flex-col h-screen overflow-hidden relative bg-background-dark">
        <header
            class="h-16 flex-shrink-0 flex items-center justify-between px-8 border-b border-slate-200 dark:border-border-dark bg-surface-dark/80 dark:bg-background-dark/80 backdrop-blur-md sticky top-0 z-40">
            <h2 id="view-title" class="text-xl font-semibold text-slate-100 dark:text-white">Dashboard Overview</h2>
            <div class="flex items-center gap-4">
                <div id="global-filter-container" class="relative hidden md:block">
                    <select id="global-event-filter" onchange="onGlobalEventFilterChange()"
                        class="bg-surface-dark border-none text-white text-sm rounded-lg py-2 pl-4 pr-10 focus:ring-1 focus:ring-primary outline-none appearance-none cursor-pointer max-w-[200px] truncate"
                        title="Global Event Filter">
                        <option value="all">All Events</option>
                    </select>
                    <span
                        class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-[18px] pointer-events-none">unfold_more</span>
                </div>
                <div class="relative hidden md:block">
                    <span
                        class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-[20px]">search</span>
                    <input
                        class="bg-surface-dark border-none text-white text-sm rounded-lg pl-10 pr-4 py-2 w-64 focus:ring-1 focus:ring-primary placeholder-slate-500"
                        placeholder="Search events, people..." type="text" />
                </div>
                <button class="relative p-2 text-slate-400 hover:text-white transition-colors">
                    <span class="material-symbols-outlined">notifications</span>
                    <span
                        class="absolute top-2 right-2 size-2 bg-red-500 rounded-full border border-background-dark"></span>
                </button>

            </div>
        </header>
        <div id="view-dashboard" class="flex-1 overflow-y-auto p-8">
            <div class="max-w-7xl mx-auto space-y-8">
                <div class="flex flex-col md:flex-row md:items-end justify-between gap-4">
                    <div>
                        <h1 class="text-3xl font-bold text-slate-100 dark:text-white mb-2">Welcome back, Alex 👋</h1>
                        <p class="text-slate-500 dark:text-slate-400">Here's what's happening across your active events
                            today.</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <span
                            class="text-xs font-medium px-2 py-1 bg-green-500/10 text-green-400 rounded border border-green-500/20 flex items-center gap-1">
                            <span class="size-1.5 rounded-full bg-green-400 animate-pulse"></span>
                            System Operational
                        </span>
                        <button onclick="syncSwapcard()"
                            class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-primary hover:bg-primary-hover rounded shadow-sm transition-colors border border-primary">
                            <span class="material-symbols-outlined text-[14px]">sync</span>
                            Sync from Swapcard
                        </button>
                        <button onclick="syncAirtable()"
                            class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded shadow-sm transition-colors border border-indigo-600">
                            <span class="material-symbols-outlined text-[14px]">table_chart</span>
                            Sync from Airtable
                        </button>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <!-- Events Card -->
                    <div
                        class="bg-surface-dark rounded-xl p-5 border border-border-dark/50 hover:border-primary/50 transition-colors group">
                        <div class="flex justify-between items-start mb-3">
                            <div class="p-2 bg-primary/10 rounded-lg text-primary">
                                <span class="material-symbols-outlined text-[20px]">event</span>
                            </div>
                            <span class="text-[10px] font-medium text-slate-500 uppercase tracking-wider">All
                                Time</span>
                        </div>
                        <p class="text-slate-400 text-xs font-medium mb-0.5">Total Events</p>
                        <h3 id="stat-total-events" class="text-3xl font-bold text-white tracking-tight">-</h3>
                    </div>

                    <!-- Registrations Card -->
                    <div
                        class="bg-surface-dark rounded-xl p-5 border border-border-dark/50 hover:border-purple-500/50 transition-colors group">
                        <div class="flex justify-between items-start mb-3">
                            <div class="p-2 bg-purple-500/10 rounded-lg text-purple-400">
                                <span class="material-symbols-outlined text-[20px]">group</span>
                            </div>
                            <span class="text-[10px] font-medium text-slate-500 uppercase tracking-wider">All
                                Time</span>
                        </div>
                        <p class="text-slate-400 text-xs font-medium mb-0.5">Registrations</p>
                        <h3 id="stat-total-people" class="text-3xl font-bold text-white tracking-tight">-</h3>
                    </div>

                    <!-- Total Leads Card -->
                    <div
                        class="bg-surface-dark rounded-xl p-5 border border-border-dark/50 hover:border-rose-500/50 transition-colors group">
                        <div class="flex justify-between items-start mb-3">
                            <div class="p-2 bg-rose-500/10 rounded-lg text-rose-400">
                                <span class="material-symbols-outlined text-[20px]">monitoring</span>
                            </div>
                            <span class="text-[10px] font-medium text-slate-500 uppercase tracking-wider">All
                                Time</span>
                        </div>
                        <p class="text-slate-400 text-xs font-medium mb-0.5">Total Leads</p>
                        <h3 id="stat-total-leads" class="text-3xl font-bold text-white tracking-tight">-</h3>
                    </div>

                    <!-- Exhibitors & Members Combined Card -->
                    <div
                        class="bg-surface-dark rounded-xl p-5 border border-border-dark/50 hover:border-amber-500/50 transition-colors group">
                        <div class="flex justify-between items-start mb-3">
                            <div class="p-2 bg-amber-500/10 rounded-lg text-amber-400">
                                <span class="material-symbols-outlined text-[20px]">storefront</span>
                            </div>
                            <span class="text-[10px] font-medium text-slate-500 uppercase tracking-wider">All
                                Time</span>
                        </div>
                        <p class="text-slate-400 text-xs font-medium mb-0.5">Exhibitors</p>
                        <div class="flex items-baseline gap-2">
                            <h3 id="stat-total-exhibitors" class="text-3xl font-bold text-white tracking-tight">-</h3>
                        </div>
                        <div class="mt-1 flex items-baseline gap-1.5">
                            <span class="material-symbols-outlined text-cyan-400 text-[14px]">badge</span>
                            <span id="stat-total-members" class="text-base font-semibold text-cyan-400">-</span>
                            <span class="text-slate-500 text-[10px]">members</span>
                        </div>
                    </div>

                    <!-- Speakers & Sessions Combined Card -->
                    <div
                        class="bg-surface-dark rounded-xl p-5 border border-border-dark/50 hover:border-blue-500/50 transition-colors group">
                        <div class="flex justify-between items-start mb-3">
                            <div class="p-2 bg-blue-500/10 rounded-lg text-blue-400">
                                <span class="material-symbols-outlined text-[20px]">podium</span>
                            </div>
                            <span class="text-[10px] font-medium text-slate-500 uppercase tracking-wider">All
                                Time</span>
                        </div>
                        <p class="text-slate-400 text-xs font-medium mb-0.5">Speakers</p>
                        <div class="flex items-baseline gap-2">
                            <h3 id="stat-total-speakers" class="text-3xl font-bold text-white tracking-tight">-</h3>
                        </div>
                        <div class="mt-1 flex items-baseline gap-1.5">
                            <span class="material-symbols-outlined text-emerald-400 text-[14px]">calendar_today</span>
                            <span id="stat-total-sessions" class="text-base font-semibold text-emerald-400">-</span>
                            <span class="text-slate-500 text-[10px]">sessions</span>
                        </div>
                    </div>
                </div>
                <div class="w-full mb-8">
                    <div class="bg-surface-dark rounded-xl border border-border-dark/50 flex flex-col">
                        <div
                            class="p-6 border-b border-border-dark/50 flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                            <h3 class="text-lg font-bold text-white flex items-center gap-2">
                                <span class="material-symbols-outlined text-slate-400">event_note</span>
                                Events Overview
                            </h3>
                            <div class="flex bg-background-dark p-1 rounded-lg">
                                <button id="tab-active" onclick="switchTab('Active')"
                                    class="px-4 py-1.5 text-xs font-medium text-white bg-surface-hover rounded shadow-sm">Active</button>
                                <button id="tab-upcoming" onclick="switchTab('Future')"
                                    class="px-4 py-1.5 text-xs font-medium text-slate-400 hover:text-white transition-colors">Upcoming</button>
                                <button id="tab-past" onclick="switchTab('Past')"
                                    class="px-4 py-1.5 text-xs font-medium text-slate-400 hover:text-white transition-colors">Past</button>
                            </div>
                        </div>
                        <div class="p-6 flex-1">
                            <div class="space-y-4" id="event-list-container">
                                <div class="text-center text-slate-400 py-10 animate-pulse">Loading Events...</div>
                            </div>
                        </div>
                        <div class="p-4 border-t border-border-dark/50">
                            <button
                                class="w-full py-2 text-sm text-primary hover:text-primary-hover font-medium transition-colors flex items-center justify-center gap-2">
                                View All Events
                                <span class="material-symbols-outlined text-[16px]">arrow_forward</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="bg-surface-dark rounded-xl border border-border-dark/50 overflow-hidden">
                    <div class="p-6 border-b border-border-dark/50">
                        <h3 class="text-lg font-bold text-white">Recent System Activity</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr
                                    class="border-b border-border-dark/50 text-xs text-slate-500 uppercase tracking-wider">
                                    <th class="p-4 font-medium">User</th>
                                    <th class="p-4 font-medium">Action</th>
                                    <th class="p-4 font-medium">Context</th>
                                    <th class="p-4 font-medium text-right">Time</th>
                                </tr>
                            </thead>
                            <tbody id="activity-tbody" class="text-sm divide-y divide-border-dark/30">
                                <tr>
                                    <td colspan="4" class="p-6 text-center text-slate-500 text-sm">Loading activity…
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- ── Event Dashboard Subpage ─────────────────────────────────────────── -->
        <div id="view-event-dashboard" class="flex-1 overflow-hidden hidden bg-[#0f1419]">
            <div class="h-full flex flex-col">
                <!-- Event Dashboard Header -->
                <div class="flex-shrink-0 px-8 py-6 border-b border-slate-700/30">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 id="event-dashboard-title" class="text-2xl font-bold text-white mb-1">Event Dashboard</h1>
                            <p id="event-dashboard-subtitle" class="text-sm text-slate-400">Select an event to view detailed analytics</p>
                        </div>
                        <div class="flex items-center gap-3">
                            <select id="event-dashboard-selector" onchange="loadEventDashboard()"
                                class="bg-[#1e2732] border border-slate-700/30 text-white text-sm rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-primary/50 outline-none min-w-[250px]">
                                <option value="">Select an event...</option>
                            </select>
                            <button onclick="refreshEventDashboard()"
                                class="size-10 bg-[#1e2732] border border-slate-700/30 rounded-xl flex items-center justify-center text-slate-400 hover:text-white hover:bg-[#252f3d] transition-all">
                                <span class="material-symbols-outlined text-[20px]">refresh</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Event Dashboard Content -->
                <div id="event-dashboard-content" class="flex-1 overflow-y-auto p-8">
                    <!-- Empty State -->
                    <div id="event-dashboard-empty" class="h-full flex items-center justify-center">
                        <div class="text-center space-y-4">
                            <div class="size-24 mx-auto rounded-2xl bg-slate-800/30 flex items-center justify-center">
                                <span class="material-symbols-outlined text-slate-600" style="font-size: 48px;">event</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-slate-400">No Event Selected</h3>
                                <p class="text-sm text-slate-600 mt-1">Choose an event from the dropdown above to view its dashboard</p>
                            </div>
                        </div>
                    </div>

                    <!-- Dashboard Grid (hidden by default) -->
                    <div id="event-dashboard-grid" class="hidden space-y-6">
                        <!-- Stats Row -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                            <!-- Exhibitors Card -->
                            <div class="bg-[#1a2332]/50 backdrop-blur-sm rounded-2xl border border-slate-700/30 p-5 hover:border-slate-600/50 transition-all">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-slate-400 text-xs font-bold uppercase tracking-wider">Exhibitors</span>
                                    <span class="material-symbols-outlined text-primary text-xl">storefront</span>
                                </div>
                                <div class="text-3xl font-black text-white" id="ed-exhibitors-count">0</div>
                                <div class="text-xs text-slate-500 mt-2">Total registered</div>
                            </div>

                            <!-- Leads Card -->
                            <div class="bg-[#1a2332]/50 backdrop-blur-sm rounded-2xl border border-slate-700/30 p-5 hover:border-slate-600/50 transition-all">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-slate-400 text-xs font-bold uppercase tracking-wider">Total Leads</span>
                                    <span class="material-symbols-outlined text-emerald-400 text-xl">trending_up</span>
                                </div>
                                <div class="text-3xl font-black text-white" id="ed-leads-count">0</div>
                                <div class="text-xs text-slate-500 mt-2">Captured leads</div>
                            </div>

                            <!-- Speakers Card -->
                            <div class="bg-[#1a2332]/50 backdrop-blur-sm rounded-2xl border border-slate-700/30 p-5 hover:border-slate-600/50 transition-all">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-slate-400 text-xs font-bold uppercase tracking-wider">Speakers</span>
                                    <span class="material-symbols-outlined text-blue-400 text-xl">podium</span>
                                </div>
                                <div class="text-3xl font-black text-white" id="ed-speakers-count">0</div>
                                <div class="text-xs text-slate-500 mt-2" id="ed-speakers-subtitle">Active speakers</div>
                            </div>

                            <!-- Sponsors Card -->
                            <div class="bg-[#1a2332]/50 backdrop-blur-sm rounded-2xl border border-slate-700/30 p-5 hover:border-slate-600/50 transition-all">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-slate-400 text-xs font-bold uppercase tracking-wider">Sponsors</span>
                                    <span class="material-symbols-outlined text-amber-400 text-xl">handshake</span>
                                </div>
                                <div class="text-3xl font-black text-white" id="ed-sponsors-count">0</div>
                                <div class="text-xs text-slate-500 mt-2">Active sponsors</div>
                            </div>
                        </div>

                        <!-- Three Column Grid matching mockup -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Left Panel - Top Exhibitors -->
                            <div class="bg-[#1a2332]/50 backdrop-blur-sm rounded-2xl border border-slate-700/30 p-6">
                                <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                                    <span class="material-symbols-outlined text-primary">emoji_events</span>
                                    Top Exhibitors
                                </h3>
                                <div id="ed-top-exhibitors" class="space-y-3">
                                    <!-- Populated by JS -->
                                    <div class="text-center py-8 text-slate-600">
                                        <span class="material-symbols-outlined text-4xl mb-2">storefront</span>
                                        <p class="text-sm">No exhibitor data available</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Center Panel - Event Stats Summary -->
                            <div class="bg-[#1a2332]/50 backdrop-blur-sm rounded-2xl border border-slate-700/30 p-6 flex flex-col">
                                <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                                    <span class="material-symbols-outlined text-emerald-400">analytics</span>
                                    Event Overview
                                </h3>
                                <div class="flex-1 flex flex-col justify-center space-y-4">
                                    <div class="p-4 rounded-xl bg-slate-800/20 border border-slate-700/20">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-xs text-slate-400 uppercase tracking-wider">Attendance Rate</span>
                                            <span class="text-lg font-bold text-emerald-400" id="ed-attendance-rate">0%</span>
                                        </div>
                                        <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                                            <div id="ed-attendance-bar" class="h-full bg-emerald-500 rounded-full transition-all duration-500" style="width: 0%"></div>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-2 gap-3">
                                        <div class="p-3 rounded-xl bg-slate-800/20">
                                            <div class="text-xs text-slate-400 mb-1">Sessions</div>
                                            <div class="text-2xl font-bold text-white" id="ed-sessions-count">0</div>
                                        </div>
                                        <div class="p-3 rounded-xl bg-slate-800/20">
                                            <div class="text-xs text-slate-400 mb-1">Attendees</div>
                                            <div class="text-2xl font-bold text-white" id="ed-attendees-count">0</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Panel - Recent Activity -->
                            <div class="bg-[#1a2332]/50 backdrop-blur-sm rounded-2xl border border-slate-700/30 p-6">
                                <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                                    <span class="material-symbols-outlined text-amber-400">schedule</span>
                                    Recent Activity
                                </h3>
                                <div id="ed-activity-feed" class="space-y-3">
                                    <!-- Populated by JS -->
                                    <div class="text-center py-8 text-slate-600">
                                        <span class="material-symbols-outlined text-4xl mb-2">history</span>
                                        <p class="text-sm">No recent activity</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ── Settings Subpage ────────────────────────────────────────────────── -->
        <div id="view-settings" class="flex-1 overflow-y-auto p-8 hidden">
            <div class="max-w-7xl mx-auto space-y-8">
                <h1 class="text-3xl font-bold text-white mb-2">System Settings</h1>
                <p class="text-slate-400">Manage API keys, sync preferences, and other system configurations.</p>

                <!-- API Keys Section -->
                <div class="bg-surface-dark rounded-xl border border-border-dark/50">
                    <div class="p-6 border-b border-border-dark/50">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2">
                            <span class="material-symbols-outlined text-slate-400">key</span>
                            API Keys
                        </h3>
                        <p class="text-slate-400 text-sm mt-1">Configure your API credentials for external services.</p>
                    </div>
                    <div class="p-6 space-y-4" id="api-keys-container">
                        <!-- API Key inputs will be rendered here by JS -->
                        <div class="text-center py-4 text-slate-500 animate-pulse">Loading API keys...</div>
                    </div>
                    <div class="flex items-center justify-end gap-3 px-6 pb-6">
                        <button onclick="saveAPIKeys()" id="save-keys-btn"
                            class="px-5 py-2 bg-primary hover:bg-primary-hover text-white text-sm font-semibold rounded-lg transition-colors flex items-center gap-2">
                            <span id="save-keys-text">Save Keys</span>
                            <span id="save-keys-spinner"
                                class="hidden material-symbols-outlined text-[14px] animate-spin">progress_activity</span>
                        </button>
                    </div>
                </div>



                <!-- Data Management & Background Sync -->
                <div class="bg-surface-dark rounded-xl border border-border-dark/50">
                    <div class="p-6 border-b border-border-dark/50">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2">
                            <span class="material-symbols-outlined text-slate-400">database</span>
                            Data Management & Background Sync
                        </h3>
                        <p class="text-slate-400 text-sm mt-1">Configure how often the local database refreshes from
                            external APIs.</p>
                    </div>
                    <div class="p-6 space-y-6">
                        <div
                            class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 p-4 rounded-lg bg-background-dark/30 border border-border-dark/20">
                            <div>
                                <p class="text-sm font-semibold text-white">Auto-Sync Interval</p>
                                <p class="text-xs text-slate-500 mt-0.5">Determines how frequently the server fetches
                                    fresh data in the background.</p>
                            </div>
                            <div class="flex items-center gap-2">
                                <select id="sync-interval-select"
                                    class="bg-surface-dark border border-border-dark/50 text-white text-sm rounded-lg px-3 py-1.5 focus:border-primary focus:ring-1 focus:ring-primary outline-none">
                                    <option value="5">Every 5 Minutes</option>
                                    <option value="15">Every 15 Minutes</option>
                                    <option value="30">Every 30 Minutes</option>
                                    <option value="60">Every Hour</option>
                                    <option value="360">Every 6 Hours</option>
                                    <option value="720">Every 12 Hours</option>
                                    <option value="1440">Once a Day</option>
                                </select>
                                <button onclick="saveSyncInterval()" id="save-interval-btn"
                                    class="px-4 py-1.5 bg-primary/10 hover:bg-primary/20 text-primary text-xs font-bold rounded-lg border border-primary/20 transition-all">
                                    Update
                                </button>
                            </div>
                        </div>

                        <div
                            class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 p-4 rounded-lg bg-background-dark/30 border border-border-dark/20">
                            <div>
                                <p class="text-sm font-semibold text-white">Manual Database Refresh</p>
                                <p class="text-xs text-slate-500 mt-0.5">Force an immediate full sync of all data
                                    (Events, Airtable, Subpages).</p>
                            </div>
                            <button onclick="triggerManualSync()" id="manual-sync-btn"
                                class="px-5 py-2 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 text-xs font-bold rounded-lg border border-indigo-500/20 transition-all flex items-center gap-2">
                                <span class="material-symbols-outlined text-[16px]">sync</span>
                                Refresh All Now
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sync Preferences Section -->
                <div class="bg-surface-dark rounded-xl border border-border-dark/50">
                    <div class="p-6 border-b border-border-dark/50">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2">
                            <span class="material-symbols-outlined text-slate-400">sync_alt</span>
                            Sync Preferences
                        </h3>
                        <p class="text-slate-400 text-sm mt-1">Control which communities and events are synced from
                            Swapcard.</p>
                    </div>
                    <div class="p-6 space-y-4">
                        <div id="communities-list" class="space-y-4">
                            <!-- Communities and events will be rendered here by JS -->
                            <div class="text-center py-12 text-slate-500 animate-pulse"><span
                                    class="material-symbols-outlined text-4xl block mb-2">hub</span>Fetching
                                communities...</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-end gap-3 px-6 pb-6">
                        <button onclick="saveSyncFilters()" id="save-filters-btn"
                            class="px-5 py-2 bg-primary hover:bg-primary-hover text-white text-sm font-semibold rounded-lg transition-colors flex items-center gap-2">
                            <span id="save-filters-text">Save Sync Preferences</span>
                            <span id="save-filters-spinner"
                                class="hidden material-symbols-outlined text-[14px] animate-spin">progress_activity</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sync Result Modal (top-right toast, auto-closes in 5s) -->
        <div id="sync-modal"
            class="fixed top-6 right-6 z-[60] w-96 bg-surface-dark border border-border-dark/60 rounded-2xl shadow-2xl transform translate-x-[120%] opacity-0 transition-all duration-500 ease-out overflow-hidden">
            <!-- Header -->
            <div id="sync-modal-header" class="flex items-center gap-3 px-5 pt-5 pb-3">
                <div id="sync-modal-icon"
                    class="size-10 rounded-xl flex items-center justify-center text-white shrink-0">
                    <span id="sync-modal-icon-sym" class="material-symbols-outlined text-[22px]">sync</span>
                </div>
                <div class="flex-1 min-w-0">
                    <p id="sync-modal-title" class="text-white font-semibold text-sm leading-tight">Sync Complete</p>
                    <p id="sync-modal-subtitle" class="text-slate-400 text-xs mt-0.5">Data is up to date</p>
                </div>
                <button onclick="closeSyncModal()"
                    class="size-7 rounded-full bg-surface-dark/5 hover:bg-surface-dark/10 flex items-center justify-center text-slate-400 hover:text-white transition-colors ml-2 shrink-0">
                    <span class="material-symbols-outlined text-[16px]">close</span>
                </button>
            </div>
            <!-- Stats row -->
            <div id="sync-modal-stats"
                class="grid grid-cols-3 gap-px bg-border-dark/30 mx-5 rounded-xl overflow-hidden mb-4">
                <!-- filled by JS -->
            </div>
            <!-- Change diff -->
            <div id="sync-modal-diff" class="px-5 pb-4 hidden">
                <div class="flex flex-wrap gap-2 text-xs" id="sync-modal-diff-tags"></div>
            </div>
            <!-- Countdown bar -->
            <div class="h-1 bg-border-dark/30 mx-5 mb-4 rounded-full overflow-hidden">
                <div id="sync-modal-bar" class="h-1 rounded-full transition-none" style="width:100%"></div>
            </div>
            <p class="text-[10px] text-slate-600 text-center pb-3">Closes automatically in <span
                    id="sync-countdown">5</span>s</p>
        </div>

        <!-- Event Details Modal -->

        <div id="event-modal-backdrop"
            class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden items-center justify-center"
            onclick="if(event.target === this) closeEventModal()">
            <div id="event-modal"
                class="bg-surface-dark border border-border-dark/50 rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl transform scale-95 opacity-0 transition-all duration-300">
                <div class="relative w-full h-40 bg-cover bg-center" id="modal-banner"
                    style="background-color: #1e293b;">
                    <button onclick="closeEventModal()"
                        class="absolute top-4 right-4 size-8 bg-black/50 hover:bg-black/80 rounded-full flex items-center justify-center text-white transition-colors">
                        <span class="material-symbols-outlined text-[18px]">close</span>
                    </button>
                    <div id="modal-stage"
                        class="absolute bottom-4 left-6 text-xs font-semibold px-2 py-1 rounded bg-indigo-500/20 text-indigo-300 border border-indigo-500/30 hidden backdrop-blur">
                        Stage</div>
                </div>
                <div
                    class="px-6 py-0 border-b border-border-dark/40 flex items-center gap-1 bg-surface-dark/50 sticky top-0 z-30 overflow-x-auto no-scrollbar">
                    <button onclick="switchEventModalTab('data')" id="modal-tab-data"
                        class="text-xs font-bold uppercase tracking-widest whitespace-nowrap text-primary border-b-2 border-primary py-4 px-3 transition-all">Event
                        Overview</button>
                    <button onclick="switchEventModalTab('registrations')" id="modal-tab-registrations"
                        class="text-xs font-bold uppercase tracking-widest whitespace-nowrap text-slate-500 hover:text-white border-b-2 border-transparent py-4 px-3 transition-all">Registrations</button>
                    <button onclick="switchEventModalTab('leads')" id="modal-tab-leads"
                        class="text-xs font-bold uppercase tracking-widest whitespace-nowrap text-slate-500 hover:text-white border-b-2 border-transparent py-4 px-3 transition-all">Leads</button>
                    <button onclick="switchEventModalTab('mobile')" id="modal-tab-mobile"
                        class="text-xs font-bold uppercase tracking-widest whitespace-nowrap text-slate-500 hover:text-white border-b-2 border-transparent py-4 px-3 transition-all">App
                        Mockup</button>
                </div>

                <div class="p-6">
                    <!-- Registration Groups View Tab (now named "registrations") -->
                    <div id="modal-view-registrations" class="space-y-6 hidden">
                        <div class="flex items-center justify-between mb-2">
                            <h3
                                class="text-sm font-bold text-primary uppercase tracking-widest flex items-center gap-2">
                                <span class="material-symbols-outlined text-[16px]">groups</span>
                                Registration Breakdown
                            </h3>
                            <span id="modal-groups-total"
                                class="text-xs font-bold text-slate-400 bg-slate-800 px-2 py-0.5 rounded-full">Total:
                                0</span>
                        </div>
                        <div id="modal-groups-list" class="flex flex-col gap-6">
                            <!-- Injected by JS -->
                        </div>
                    </div>

                    <!-- Data View Tab -->
                    <div id="modal-view-data" class="space-y-6">
                        <div class="flex items-start gap-4 mb-6">
                            <div class="flex-1">
                                <h2 id="modal-title" class="text-2xl font-bold text-white mb-2">Event Title</h2>
                                <div class="flex flex-wrap items-center gap-4">
                                    <span class="text-sm text-slate-400 flex items-center gap-1"><span
                                            class="material-symbols-outlined text-[14px]">calendar_today</span> <span
                                            id="modal-dates-text">Dates</span></span>
                                    <span class="text-sm text-slate-400 flex items-center gap-1"><span
                                            class="material-symbols-outlined text-[14px]">location_on</span> <span
                                            id="modal-location-text">Location</span></span>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3 mb-8">
                            <!-- Swapcard stats -->
                            <div class="bg-background-dark/50 rounded-lg p-3 border border-border-dark/30 text-center">
                                <p class="text-[9px] text-slate-500 mb-1 uppercase tracking-wider font-bold">
                                    Registrations
                                </p>
                                <p id="modal-reg" class="text-base font-bold text-slate-200">-</p>
                            </div>
                            <div
                                class="bg-background-dark/50 rounded-lg p-3 border border-border-dark/30 text-center ring-1 ring-blue-500/20">
                                <p class="text-[9px] text-blue-400 mb-1 uppercase tracking-wider font-bold">
                                    Speakers
                                </p>
                                <p id="modal-spk" class="text-base font-bold text-blue-400">-</p>
                            </div>
                            <div class="bg-background-dark/50 rounded-lg p-3 border border-border-dark/30 text-center">
                                <p class="text-[9px] text-slate-500 mb-1 uppercase tracking-wider font-bold">Exhibitors
                                </p>
                                <p id="modal-exh" class="text-base font-bold text-slate-200">-</p>
                            </div>
                            <div
                                class="bg-background-dark/50 rounded-lg p-3 border border-border-dark/30 text-center ring-1 ring-amber-500/20">
                                <p class="text-[9px] text-amber-500/80 mb-1 uppercase tracking-wider font-bold">Exh.
                                    Members
                                </p>
                                <p id="modal-members" class="text-base font-bold text-amber-400">-</p>
                            </div>
                            <div class="bg-background-dark/50 rounded-lg p-3 border border-border-dark/30 text-center">
                                <p class="text-[9px] text-slate-500 mb-1 uppercase tracking-wider font-bold">Sessions
                                </p>
                                <p id="modal-sess" class="text-base font-bold text-slate-200">-</p>
                            </div>
                        </div>

                        <!-- Airtable Detailed Info -->
                        <div id="airtable-details-section" class="hidden">
                            <h3
                                class="text-sm font-bold text-primary uppercase tracking-widest mb-4 flex items-center gap-2">
                                <span class="material-symbols-outlined text-[16px]">integration_instructions</span>
                                Airtable
                                Sync Data
                            </h3>

                            <!-- Progress bar -->
                            <div class="mb-5 bg-background-dark/30 p-4 rounded-lg border border-border-dark/20">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-xs text-slate-500 uppercase tracking-wider font-semibold">Task
                                        Progress</span>
                                    <span id="modal-progress-label" class="text-xs font-bold text-slate-200">-</span>
                                </div>
                                <div class="w-full h-2 bg-border-dark/50 rounded-full overflow-hidden">
                                    <div id="modal-progress-bar"
                                        class="h-2 bg-primary rounded-full transition-all duration-700"
                                        style="width:0%">
                                    </div>
                                </div>
                                <p id="modal-tasks-label" class="text-[10px] text-slate-500 mt-1.5">0 / 0 tasks done</p>
                            </div>

                            <div
                                class="grid grid-cols-2 md:grid-cols-3 gap-y-5 gap-x-6 text-sm bg-background-dark/30 p-5 rounded-lg border border-border-dark/20">
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Project Lead</p>
                                    <p id="modal-lead" class="text-slate-200 font-medium text-sm">-</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Stage</p>
                                    <p id="modal-stage-label" class="text-slate-200 font-medium text-sm">-</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">App Status</p>
                                    <p id="modal-app-status" class="text-slate-200 font-medium text-sm">-</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">App Ready Date</p>
                                    <p id="modal-app-ready" class="text-slate-200 font-medium text-sm">-</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Event ID</p>
                                    <p id="modal-event-id" class="text-slate-200 font-medium text-sm">-</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Exhibitor Launch</p>
                                    <p id="modal-elab" class="text-slate-200 font-medium text-sm">-</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Visitor Launch</p>
                                    <p id="modal-vlab" class="text-slate-200 font-medium text-sm">-</p>
                                </div>
                                <div class="col-span-2 md:col-span-3">
                                    <p class="text-slate-500 text-xs mb-2">Tech Stack</p>
                                    <div id="modal-tech" class="flex flex-wrap gap-3"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Call to action msg if airtight not found -->
                        <div id="airtable-missing-section"
                            class="mt-4 p-4 rounded-lg bg-border-dark/20 border border-border-dark/40 text-center">
                            <p class="text-xs text-slate-400">No extended configuration detected in Airtable for this
                                event.
                            </p>
                        </div>

                    </div> <!-- End of modal-view-data -->

                    <!-- Leads Tab -->
                    <div id="modal-view-leads" class="hidden space-y-5">
                        <!-- Header row -->
                        <div class="flex items-center justify-between">
                            <h3
                                class="text-sm font-bold text-primary uppercase tracking-widest flex items-center gap-2">
                                <span class="material-symbols-outlined text-[16px]">monitoring</span>
                                Lead Activity
                            </h3>
                            <span id="modal-leads-synced" class="text-[10px] text-slate-600 font-medium">—</span>
                        </div>

                        <!-- Total leads hero -->
                        <div
                            class="relative rounded-2xl overflow-hidden bg-gradient-to-br from-rose-500/15 via-pink-500/10 to-transparent border border-rose-500/20 p-6">
                            <div
                                class="absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,rgba(244,63,94,0.12),transparent_60%)] pointer-events-none">
                            </div>
                            <div class="flex items-end justify-between">
                                <div>
                                    <p class="text-xs font-bold uppercase tracking-widest text-rose-400/70 mb-1">Total
                                        Leads</p>
                                    <p id="modal-leads-total" class="text-5xl font-black text-white tracking-tight">—
                                    </p>
                                    <p class="text-xs text-slate-500 mt-1">Unique engagement actions attributed to this
                                        event</p>
                                </div>
                                <span
                                    class="material-symbols-outlined text-rose-500/20 text-[80px] leading-none -mb-2">insights</span>
                            </div>
                        </div>

                        <!-- 8 lead type cards -->
                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                            <!-- Views -->
                            <div
                                class="bg-background-dark/60 border border-border-dark/40 hover:border-sky-500/30 rounded-xl p-4 transition-colors group">
                                <div class="flex items-center gap-2 mb-3">
                                    <div
                                        class="size-7 rounded-lg bg-sky-500/10 flex items-center justify-center shrink-0">
                                        <span
                                            class="material-symbols-outlined text-sky-400 text-[16px]">visibility</span>
                                    </div>
                                    <span class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Booth
                                        Views</span>
                                </div>
                                <p id="modal-leads-views" class="text-3xl font-black text-white tracking-tight">—
                                </p>
                                <p class="text-[10px] text-slate-600 mt-1">Attendees who viewed an exhibitor booth
                                </p>
                            </div>

                            <!-- Bookmarks -->
                            <div
                                class="bg-background-dark/60 border border-border-dark/40 hover:border-amber-500/30 rounded-xl p-4 transition-colors group">
                                <div class="flex items-center gap-2 mb-3">
                                    <div
                                        class="size-7 rounded-lg bg-amber-500/10 flex items-center justify-center shrink-0">
                                        <span
                                            class="material-symbols-outlined text-amber-400 text-[16px]">bookmark</span>
                                    </div>
                                    <span
                                        class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Bookmarks</span>
                                </div>
                                <p id="modal-leads-bookmarks" class="text-3xl font-black text-white tracking-tight">—
                                </p>
                                <p class="text-[10px] text-slate-600 mt-1">Attendees who saved this event's exhibitors
                                </p>
                            </div>

                            <!-- Connections -->
                            <div
                                class="bg-background-dark/60 border border-border-dark/40 hover:border-emerald-500/30 rounded-xl p-4 transition-colors group">
                                <div class="flex items-center gap-2 mb-3">
                                    <div
                                        class="size-7 rounded-lg bg-emerald-500/10 flex items-center justify-center shrink-0">
                                        <span
                                            class="material-symbols-outlined text-emerald-400 text-[16px]">handshake</span>
                                    </div>
                                    <span
                                        class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Connections</span>
                                </div>
                                <p id="modal-leads-connections" class="text-3xl font-black text-white tracking-tight">—
                                </p>
                                <p class="text-[10px] text-slate-600 mt-1">Direct 1-to-1 connections made on the
                                    platform</p>
                            </div>

                            <!-- Scans -->
                            <div
                                class="bg-background-dark/60 border border-border-dark/40 hover:border-blue-500/30 rounded-xl p-4 transition-colors group">
                                <div class="flex items-center gap-2 mb-3">
                                    <div
                                        class="size-7 rounded-lg bg-blue-500/10 flex items-center justify-center shrink-0">
                                        <span
                                            class="material-symbols-outlined text-blue-400 text-[16px]">qr_code_scanner</span>
                                    </div>
                                    <span class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Badge
                                        Scans</span>
                                </div>
                                <p id="modal-leads-scans" class="text-3xl font-black text-white tracking-tight">—</p>
                                <p class="text-[10px] text-slate-600 mt-1">Booth badge scans at exhibitor stands</p>
                            </div>

                            <!-- Contacts -->
                            <div
                                class="bg-background-dark/60 border border-border-dark/40 hover:border-purple-500/30 rounded-xl p-4 transition-colors group">
                                <div class="flex items-center gap-2 mb-3">
                                    <div
                                        class="size-7 rounded-lg bg-purple-500/10 flex items-center justify-center shrink-0">
                                        <span
                                            class="material-symbols-outlined text-purple-400 text-[16px]">contact_page</span>
                                    </div>
                                    <span class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Contact
                                        Cards</span>
                                </div>
                                <p id="modal-leads-contacts" class="text-3xl font-black text-white tracking-tight">—</p>
                                <p class="text-[10px] text-slate-600 mt-1">Contact card exchanges via the app</p>
                            </div>

                            <!-- Requests -->
                            <div
                                class="bg-background-dark/60 border border-border-dark/40 hover:border-pink-500/30 rounded-xl p-4 transition-colors group">
                                <div class="flex items-center gap-2 mb-3">
                                    <div
                                        class="size-7 rounded-lg bg-pink-500/10 flex items-center justify-center shrink-0">
                                        <span
                                            class="material-symbols-outlined text-pink-400 text-[16px]">person_add</span>
                                    </div>
                                    <span
                                        class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Requests</span>
                                </div>
                                <p id="modal-leads-requests" class="text-3xl font-black text-white tracking-tight">—</p>
                                <p class="text-[10px] text-slate-600 mt-1">Connection requests sent</p>
                            </div>

                            <!-- Messages -->
                            <div
                                class="bg-background-dark/60 border border-border-dark/40 hover:border-indigo-500/30 rounded-xl p-4 transition-colors group">
                                <div class="flex items-center gap-2 mb-3">
                                    <div
                                        class="size-7 rounded-lg bg-indigo-500/10 flex items-center justify-center shrink-0">
                                        <span class="material-symbols-outlined text-indigo-400 text-[16px]">chat</span>
                                    </div>
                                    <span
                                        class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Messages</span>
                                </div>
                                <p id="modal-leads-messages" class="text-3xl font-black text-white tracking-tight">—</p>
                                <p class="text-[10px] text-slate-600 mt-1">Direct messages exchanged</p>
                            </div>

                            <!-- Meetings -->
                            <div
                                class="bg-background-dark/60 border border-border-dark/40 hover:border-teal-500/30 rounded-xl p-4 transition-colors group">
                                <div class="flex items-center gap-2 mb-3">
                                    <div
                                        class="size-7 rounded-lg bg-teal-500/10 flex items-center justify-center shrink-0">
                                        <span class="material-symbols-outlined text-teal-400 text-[16px]">event</span>
                                    </div>
                                    <span
                                        class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Meetings</span>
                                </div>
                                <p id="modal-leads-meetings" class="text-3xl font-black text-white tracking-tight">—</p>
                                <p class="text-[10px] text-slate-600 mt-1">Meetings created</p>
                            </div>
                        </div>

                        <!-- Visual breakdown bar -->
                        <div class="bg-background-dark/40 border border-border-dark/30 rounded-xl p-4">
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-3">Lead
                                Breakdown</p>
                            <div id="modal-leads-bar" class="flex h-3 rounded-full overflow-hidden gap-0.5 mb-3">
                                <!-- Injected by JS -->
                            </div>
                            <div class="flex flex-wrap gap-x-5 gap-y-1.5">
                                <div class="flex items-center gap-1.5">
                                    <div class="size-2.5 rounded-sm bg-sky-400"></div>
                                    <span class="text-[10px] text-slate-400">Views</span>
                                </div>
                                <div class="flex items-center gap-1.5">
                                    <div class="size-2.5 rounded-sm bg-amber-400"></div>
                                    <span class="text-[10px] text-slate-400">Bookmarks</span>
                                </div>
                                <div class="flex items-center gap-1.5">
                                    <div class="size-2.5 rounded-sm bg-emerald-400"></div>
                                    <span class="text-[10px] text-slate-400">Connections</span>
                                </div>
                                <div class="flex items-center gap-1.5">
                                    <div class="size-2.5 rounded-sm bg-blue-400"></div>
                                    <span class="text-[10px] text-slate-400">Scans</span>
                                </div>
                                <div class="flex items-center gap-1.5">
                                    <div class="size-2.5 rounded-sm bg-purple-400"></div>
                                    <span class="text-[10px] text-slate-400">Contacts</span>
                                </div>
                                <div class="flex items-center gap-1.5">
                                    <div class="size-2.5 rounded-sm bg-pink-400"></div>
                                    <span class="text-[10px] text-slate-400">Requests</span>
                                </div>
                                <div class="flex items-center gap-1.5">
                                    <div class="size-2.5 rounded-sm bg-indigo-400"></div>
                                    <span class="text-[10px] text-slate-400">Messages</span>
                                </div>
                                <div class="flex items-center gap-1.5">
                                    <div class="size-2.5 rounded-sm bg-teal-400"></div>
                                    <span class="text-[10px] text-slate-400">Meetings</span>
                                </div>
                            </div>
                        </div>
                    </div> <!-- End modal-view-leads -->

                    <div id="modal-view-mockup"
                        class="hidden flex flex-col items-center py-6 bg-background-dark/20 rounded-xl">
                        <div
                            class="relative w-[300px] h-[600px] bg-slate-900 rounded-[3rem] border-[8px] border-slate-800 shadow-[0_0_50px_rgba(0,0,0,0.5)] overflow-hidden flex flex-col ring-1 ring-white/10 scale-90 sm:scale-100 origin-top">
                            <!-- Dynamic Island -->
                            <div class="absolute top-2 left-1/2 -translate-x-1/2 w-24 h-6 bg-black rounded-full z-50">
                            </div>
                            <img id="modal-mockup-img" src="" class="w-full h-full object-cover">
                        </div>
                    </div>

                    <!-- Mobile Simulation Tab -->
                    <div id="modal-view-mobile"
                        class="hidden flex flex-col items-center py-6 bg-background-dark/20 rounded-xl">
                        <!-- Phone Frame Mockup -->
                        <div
                            class="relative w-[300px] h-[600px] bg-slate-900 rounded-[3rem] border-[8px] border-slate-800 shadow-[0_0_50px_rgba(0,0,0,0.5)] overflow-hidden flex flex-col ring-1 ring-white/10 scale-90 sm:scale-100 origin-top">
                            <!-- Dynamic Island -->
                            <div class="absolute top-2 left-1/2 -translate-x-1/2 w-24 h-6 bg-black rounded-full z-50">
                            </div>

                            <!-- App Content Simulator -->
                            <div id="sim-app-content"
                                class="flex-1 bg-white text-slate-900 flex flex-col overflow-hidden relative">
                                <!-- Status bar -->
                                <div class="h-10 flex items-center justify-between px-6 pt-4 text-[10px] font-bold">
                                    <span>9:41</span>
                                    <div class="flex items-center gap-1">
                                        <span class="material-symbols-outlined text-[12px]">signal_cellular_4_bar</span>
                                        <span class="material-symbols-outlined text-[12px]">wifi</span>
                                        <span class="material-symbols-outlined text-[12px]">battery_full</span>
                                    </div>
                                </div>

                                <!-- App Header -->
                                <div class="px-5 py-2 flex items-center gap-3 border-b border-slate-100">
                                    <span class="material-symbols-outlined text-slate-400 text-lg">menu</span>
                                    <div class="min-w-0">
                                        <p
                                            class="text-[10px] font-bold text-primary uppercase tracking-tighter leading-none mb-0.5">
                                            Event home</p>
                                        <p id="sim-event-name"
                                            class="text-[11px] font-bold text-slate-500 truncate leading-none">Cityscape
                                            Global 2026</p>
                                    </div>
                                </div>

                                <!-- Scrollable App Body -->
                                <div id="sim-scroll-body" class="flex-1 overflow-y-auto no-scrollbar pb-20">
                                    <!-- Hero Banner -->
                                    <div id="sim-banner"
                                        class="w-full aspect-[2/1] bg-slate-200 relative overflow-hidden">
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent">
                                        </div>
                                        <div class="absolute bottom-3 left-3 flex items-center gap-2">
                                            <div id="sim-logo"
                                                class="size-8 rounded border border-white/20 bg-white/10 backdrop-blur-sm shadow-sm flex items-center justify-center p-1 overflow-hidden"
                                                style="display:none">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Navigation Grid -->
                                    <div id="sim-nav-grid" class="grid grid-cols-2 gap-2 p-4">
                                        <!-- Buttons injected by JS -->
                                    </div>

                                    <!-- Quick Links -->
                                    <div class="px-4 py-2">
                                        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3">
                                            Quick Links</p>
                                        <div id="sim-quick-links" class="flex gap-3 overflow-x-auto pb-2 no-scrollbar">
                                            <!-- Icons injected by JS -->
                                        </div>
                                    </div>

                                    <!-- Partners -->
                                    <div id="sim-partners-section"
                                        class="px-4 py-4 mt-2 border-t border-slate-50 hidden">
                                        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3">
                                            Founding Partners</p>
                                        <div id="sim-partners-list" class="flex gap-4 items-center">
                                            <!-- Logos injected by JS -->
                                        </div>
                                    </div>
                                </div>

                                <!-- Bottom Navigation Bar -->
                                <div
                                    class="absolute bottom-0 inset-x-0 h-16 bg-white border-t border-slate-100 flex items-center justify-around px-4 z-40 pb-2">
                                    <div class="flex flex-col items-center gap-0.5 text-primary">
                                        <span class="material-symbols-outlined text-xl">home</span>
                                    </div>
                                    <div class="flex flex-col items-center gap-0.5 text-slate-300">
                                        <span class="material-symbols-outlined text-xl">notifications</span>
                                    </div>
                                    <div id="sim-fab"
                                        class="size-10 rounded-full bg-primary -mt-6 shadow-lg shadow-primary/30 flex items-center justify-center text-white ring-4 ring-white">
                                        <span class="material-symbols-outlined text-xl">qr_code_scanner</span>
                                    </div>
                                    <div class="flex flex-col items-center gap-0.5 text-slate-300">
                                        <span class="material-symbols-outlined text-xl">chat_bubble</span>
                                    </div>
                                    <div class="flex flex-col items-center gap-0.5 text-slate-300">
                                        <span class="material-symbols-outlined text-xl">person</span>
                                    </div>
                                </div>

                                <!-- Home indicator -->
                                <div
                                    class="absolute bottom-1 left-1/2 -translate-x-1/2 w-20 h-1 bg-slate-200 rounded-full z-50">
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Exhibitor Detailed Profile Slide-out Panel -->
        <div id="exhibitor-panel-backdrop"
            class="fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm hidden items-center justify-end dialog-backdrop"
            onclick="if(event.target===this) closeExhibitorPanel()">
            <div id="exhibitor-side-panel"
                class="bg-[#0f172a] border-l border-border-dark w-full max-w-xl h-full shadow-2xl transform translate-x-full transition-transform duration-300 overflow-hidden flex flex-col relative">
                <div id="exhibitor-panel-content" class="flex flex-col h-full overflow-hidden">
                    <!-- Data will be injected here via subpages.js -->
                    <div class="flex items-center justify-center h-full">
                        <div class="shimmer w-12 h-12 rounded-full"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Person Detailed Profile Slide-out Panel -->
        <div id="person-panel-backdrop"
            class="fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm hidden items-center justify-end dialog-backdrop"
            onclick="if(event.target===this) closePersonPanel()">
            <div id="person-side-panel"
                class="bg-[#0f172a] border-l border-border-dark w-full max-w-xl h-full shadow-2xl transform translate-x-full transition-transform duration-300 overflow-hidden flex flex-col relative">
                <div id="person-panel-content" class="flex flex-col h-full overflow-hidden">
                    <!-- Data will be injected here via subpages.js -->
                    <div class="flex items-center justify-center h-full">
                        <div class="shimmer w-12 h-12 rounded-full"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Session Detailed Profile Slide-out Panel -->
        <div id="session-panel-backdrop"
            class="fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm hidden items-center justify-end dialog-backdrop"
            onclick="if(event.target===this) closeSessionPanel()">
            <div id="session-side-panel"
                class="bg-[#0f172a] border-l border-border-dark w-full max-w-xl h-full shadow-2xl transform translate-x-full transition-transform duration-300 overflow-hidden flex flex-col relative">
                <div id="session-panel-content" class="flex flex-col h-full overflow-hidden">
                    <!-- Data will be injected here via subpages.js -->
                    <div class="flex items-center justify-center h-full">
                        <div class="shimmer w-12 h-12 rounded-full"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sponsor Detailed Profile Slide-out Panel -->
        <div id="sponsor-panel-backdrop"
            class="fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm hidden items-center justify-end dialog-backdrop"
            onclick="if(event.target===this) closeSponsorPanel()">
            <div id="sponsor-side-panel"
                class="bg-[#0f172a] border-l border-border-dark w-full max-w-xl h-full shadow-2xl transform translate-x-full transition-transform duration-300 overflow-hidden flex flex-col relative">
                <div id="sponsor-panel-content" class="flex flex-col h-full overflow-hidden">
                    <!-- Data will be injected here via subpages.js -->
                    <div class="flex items-center justify-center h-full">
                        <div class="shimmer w-12 h-12 rounded-full"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════════════════════════════════════ -->
        <!-- CLAUDE CHAT WIDGET (Floating Overlay) -->
        <!-- ══════════════════════════════════════════════════════════════════════ -->

        <!-- Floating Chat Button (collapsed state) -->
        <button id="claude-chat-button" onclick="toggleChatWidget()"
            class="fixed bottom-6 right-6 z-[100] w-14 h-14 bg-primary hover:bg-primary-hover rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 hover:scale-110">
            <span class="material-symbols-outlined text-white text-2xl">smart_toy</span>
        </button>

        <!-- Chat Widget Container (expanded state) -->
        <div id="claude-chat-widget" class="fixed bottom-6 right-6 z-[100] hidden">
            <div id="claude-chat-panel"
                class="bg-[#0f172a] border border-border-dark rounded-2xl shadow-2xl w-[380px] flex flex-col transition-all duration-300 overflow-hidden"
                style="height: 500px;">

                <!-- Header -->
                <div
                    class="flex items-center justify-between px-4 py-3 border-b border-border-dark/40 bg-surface-dark/50">
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary text-xl">smart_toy</span>
                        <h2 class="text-sm font-bold text-white">Claude AI</h2>
                    </div>
                    <div class="flex items-center gap-1">
                        <button id="expand-chat-btn" onclick="expandChatWidget()"
                            class="material-symbols-outlined text-slate-400 hover:text-white p-1 rounded hover:bg-surface-hover transition-colors text-lg"
                            title="Expand to sidebar">open_in_full</button>
                        <button onclick="toggleChatWidget()"
                            class="material-symbols-outlined text-slate-400 hover:text-white p-1 rounded hover:bg-surface-hover transition-colors text-lg"
                            title="Minimize">minimize</button>
                    </div>
                </div>

                <!-- Session Selector (compact) -->
                <div class="px-3 py-2 border-b border-border-dark/40 bg-surface-dark/30">
                    <select id="claude-session-select" onchange="switchChatSession(this.value)"
                        class="w-full bg-background-dark border border-border-dark/60 rounded px-2 py-1.5 text-xs text-white focus:border-primary focus:ring-1 focus:ring-primary/40">
                        <option value="new">+ New Chat</option>
                    </select>
                </div>

                <!-- Message List (scrollable) -->
                <div id="claude-messages" class="flex-1 overflow-y-auto px-3 py-3 space-y-3 custom-scrollbar">
                    <!-- Welcome message -->
                    <div class="flex items-start gap-2">
                        <div class="mt-0.5 shrink-0">
                            <span class="material-symbols-outlined text-primary text-lg">smart_toy</span>
                        </div>
                        <div class="flex-1">
                            <div class="text-[10px] text-slate-500 mb-0.5">Claude</div>
                            <div class="text-xs text-slate-300 leading-relaxed">
                                Hi! I'm your AI assistant. Ask me anything about SwapcardOS, or take screenshots to show
                                me what you need help with.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Screenshot Preview (when attached) -->
                <div id="claude-screenshot-preview" class="hidden px-3 py-2 border-t border-border-dark/40">
                    <div class="relative inline-block">
                        <img id="claude-screenshot-img" class="max-h-20 rounded border border-border-dark/60">
                        <button onclick="removeScreenshot()"
                            class="absolute -top-1 -right-1 bg-red-500 hover:bg-red-600 rounded-full p-0.5 transition-colors">
                            <span class="material-symbols-outlined text-white text-xs">close</span>
                        </button>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="px-3 py-3 border-t border-border-dark/40 bg-surface-dark/30">
                    <div class="flex items-end gap-1.5">
                        <textarea id="claude-input" rows="1" placeholder="Ask Claude..."
                            class="flex-1 bg-background-dark border border-border-dark/60 rounded-lg px-2.5 py-2 text-xs text-white resize-none focus:border-primary focus:ring-1 focus:ring-primary/40 max-h-24"
                            onkeydown="if(event.key==='Enter' && !event.shiftKey) { event.preventDefault(); sendClaudeMessage(); }"
                            oninput="this.style.height='auto'; this.style.height=this.scrollHeight+'px'"></textarea>
                        <button onclick="captureScreenshot()"
                            class="material-symbols-outlined bg-surface-dark hover:bg-surface-hover text-slate-300 hover:text-white p-2 rounded-lg transition-colors text-base"
                            title="Screenshot">screenshot_monitor</button>
                        <button id="claude-send-btn" onclick="sendClaudeMessage()"
                            class="material-symbols-outlined bg-primary hover:bg-primary-hover text-white p-2 rounded-lg transition-colors text-base"
                            title="Send">send</button>
                    </div>
                    <div id="claude-typing" class="hidden mt-1.5 text-[10px] text-slate-400">
                        <span class="inline-flex gap-0.5 items-center">
                            <span class="animate-bounce" style="animation-delay: 0ms">●</span>
                            <span class="animate-bounce" style="animation-delay: 150ms">●</span>
                            <span class="animate-bounce" style="animation-delay: 300ms">●</span>
                            <span class="ml-1">Typing...</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Expanded Sidebar Mode -->
        <div id="claude-chat-expanded"
            class="fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm hidden items-center justify-end"
            onclick="if(event.target===this) collapseChatWidget()">
            <div
                class="fixed right-0 top-0 h-full w-full md:w-[600px] bg-[#0f172a] border-l border-border-dark shadow-2xl flex flex-col">

                <!-- Expanded Header -->
                <div class="flex items-center justify-between px-6 py-4 border-b border-border-dark/40">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-primary text-2xl">smart_toy</span>
                        <h2 class="text-lg font-bold text-white">Claude Assistant</h2>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="collapseChatWidget()"
                            class="material-symbols-outlined text-slate-400 hover:text-white p-1 rounded hover:bg-surface-hover transition-colors"
                            title="Collapse to widget">close_fullscreen</button>
                        <button onclick="closeChatCompletely()"
                            class="material-symbols-outlined text-slate-400 hover:text-white transition-colors">close</button>
                    </div>
                </div>

                <!-- Expanded Session Selector -->
                <div class="px-6 py-3 border-b border-border-dark/40">
                    <select id="claude-session-select-expanded" onchange="switchChatSession(this.value)"
                        class="w-full bg-background-dark border border-border-dark/60 rounded-lg px-3 py-2 text-sm text-white focus:border-primary focus:ring-1 focus:ring-primary/40">
                        <option value="new">+ New Chat</option>
                    </select>
                </div>

                <!-- Expanded Message List -->
                <div id="claude-messages-expanded" class="flex-1 overflow-y-auto px-6 py-4 space-y-4 custom-scrollbar">
                    <!-- Messages will be synced from widget -->
                </div>

                <!-- Expanded Screenshot Preview -->
                <div id="claude-screenshot-preview-expanded" class="hidden px-6 py-2 border-t border-border-dark/40">
                    <div class="relative inline-block">
                        <img id="claude-screenshot-img-expanded" class="max-h-32 rounded border border-border-dark/60">
                        <button onclick="removeScreenshot()"
                            class="absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 rounded-full p-1 transition-colors">
                            <span class="material-symbols-outlined text-white text-sm">close</span>
                        </button>
                    </div>
                </div>

                <!-- Expanded Input Area -->
                <div class="px-6 py-4 border-t border-border-dark/40">
                    <div class="flex items-end gap-2">
                        <textarea id="claude-input-expanded" rows="1" placeholder="Ask Claude anything..."
                            class="flex-1 bg-background-dark border border-border-dark/60 rounded-lg px-3 py-2.5 text-white resize-none focus:border-primary focus:ring-1 focus:ring-primary/40 max-h-32"
                            onkeydown="if(event.key==='Enter' && !event.shiftKey) { event.preventDefault(); sendClaudeMessage(); }"
                            oninput="this.style.height='auto'; this.style.height=this.scrollHeight+'px'"></textarea>
                        <button onclick="captureScreenshot()"
                            class="material-symbols-outlined bg-surface-dark hover:bg-surface-hover text-slate-300 hover:text-white p-3 rounded-lg transition-colors"
                            title="Capture screenshot">screenshot_monitor</button>
                        <button id="claude-send-btn-expanded" onclick="sendClaudeMessage()"
                            class="material-symbols-outlined bg-primary hover:bg-primary-hover text-white p-3 rounded-lg transition-colors"
                            title="Send message">send</button>
                    </div>
                    <div id="claude-typing-expanded" class="hidden mt-2 text-xs text-slate-400">
                        <span class="inline-flex gap-1 items-center">
                            <span class="animate-bounce" style="animation-delay: 0ms">●</span>
                            <span class="animate-bounce" style="animation-delay: 150ms">●</span>
                            <span class="animate-bounce" style="animation-delay: 300ms">●</span>
                            <span class="ml-2">Claude is typing...</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════════════════════════════════════ -->
        <!-- ANNOTATION CANVAS MODAL -->
        <!-- ══════════════════════════════════════════════════════════════════════ -->
        <div id="annotation-backdrop" class="fixed inset-0 z-[110] bg-black/90 hidden">
            <div class="flex flex-col h-full p-4">

                <!-- Toolbar -->
                <div class="flex items-center gap-3 bg-surface-dark p-3 rounded-lg mb-2 flex-wrap">
                    <!-- Tools -->
                    <div class="flex gap-2">
                        <button onclick="setAnnotationTool('freehand')" id="tool-freehand"
                            class="annotation-tool px-3 py-2 rounded bg-primary text-white transition-colors"
                            title="Freehand drawing">
                            <span class="material-symbols-outlined text-sm">draw</span>
                        </button>
                        <button onclick="setAnnotationTool('arrow')" id="tool-arrow"
                            class="annotation-tool px-3 py-2 rounded hover:bg-surface-hover text-slate-300 transition-colors"
                            title="Draw arrow">
                            <span class="material-symbols-outlined text-sm">arrow_forward</span>
                        </button>
                        <button onclick="setAnnotationTool('rectangle')" id="tool-rectangle"
                            class="annotation-tool px-3 py-2 rounded hover:bg-surface-hover text-slate-300 transition-colors"
                            title="Draw rectangle">
                            <span class="material-symbols-outlined text-sm">rectangle</span>
                        </button>
                        <button onclick="setAnnotationTool('text')" id="tool-text"
                            class="annotation-tool px-3 py-2 rounded hover:bg-surface-hover text-slate-300 transition-colors"
                            title="Add text">
                            <span class="material-symbols-outlined text-sm">text_fields</span>
                        </button>
                    </div>

                    <!-- Stroke Width -->
                    <div class="flex gap-1 items-center border-l border-border-dark/60 pl-3">
                        <span class="text-xs text-slate-500 mr-2">Width:</span>
                        <button onclick="setStrokeWidth(2)"
                            class="w-8 h-8 rounded hover:bg-surface-hover flex items-center justify-center">
                            <div class="w-1 h-1 bg-surface-dark rounded-full"></div>
                        </button>
                        <button onclick="setStrokeWidth(4)"
                            class="w-8 h-8 rounded hover:bg-surface-hover flex items-center justify-center">
                            <div class="w-2 h-2 bg-surface-dark rounded-full"></div>
                        </button>
                        <button onclick="setStrokeWidth(6)"
                            class="w-8 h-8 rounded hover:bg-surface-hover flex items-center justify-center">
                            <div class="w-3 h-3 bg-surface-dark rounded-full"></div>
                        </button>
                        <button onclick="setStrokeWidth(8)"
                            class="w-8 h-8 rounded hover:bg-surface-hover flex items-center justify-center">
                            <div class="w-4 h-4 bg-surface-dark rounded-full"></div>
                        </button>
                    </div>

                    <!-- Colors -->
                    <div class="flex gap-1 items-center border-l border-border-dark/60 pl-3">
                        <span class="text-xs text-slate-500 mr-2">Color:</span>
                        <button onclick="setAnnotationColor('#ef4444')"
                            class="w-6 h-6 rounded-full bg-red-500 border-2 border-white hover:scale-110 transition-transform"></button>
                        <button onclick="setAnnotationColor('#eab308')"
                            class="w-6 h-6 rounded-full bg-yellow-500 border-2 border-transparent hover:border-white hover:scale-110 transition-all"></button>
                        <button onclick="setAnnotationColor('#22c55e')"
                            class="w-6 h-6 rounded-full bg-green-500 border-2 border-transparent hover:border-white hover:scale-110 transition-all"></button>
                        <button onclick="setAnnotationColor('#3b82f6')"
                            class="w-6 h-6 rounded-full bg-blue-500 border-2 border-transparent hover:border-white hover:scale-110 transition-all"></button>
                        <button onclick="setAnnotationColor('#ffffff')"
                            class="w-6 h-6 rounded-full bg-surface-dark border-2 border-transparent hover:border-slate-400 hover:scale-110 transition-all"></button>
                    </div>

                    <!-- Actions -->
                    <div class="flex-1"></div>
                    <div class="flex gap-2 border-l border-border-dark/60 pl-3">
                        <button onclick="annotationUndo()"
                            class="material-symbols-outlined text-slate-300 hover:text-white p-2 hover:bg-surface-hover rounded transition-colors"
                            title="Undo">undo</button>
                        <button onclick="annotationRedo()"
                            class="material-symbols-outlined text-slate-300 hover:text-white p-2 hover:bg-surface-hover rounded transition-colors"
                            title="Redo">redo</button>
                        <button onclick="annotationClear()"
                            class="material-symbols-outlined text-slate-300 hover:text-white p-2 hover:bg-surface-hover rounded transition-colors"
                            title="Clear all">delete</button>
                    </div>
                    <button onclick="closeAnnotation()"
                        class="px-4 py-2 bg-surface-hover hover:bg-border-dark rounded text-white transition-colors">Cancel</button>
                    <button onclick="finalizeAnnotation()"
                        class="px-4 py-2 bg-primary hover:bg-primary-hover rounded text-white transition-colors">Done</button>
                </div>

                <!-- Canvas Container -->
                <div class="flex-1 flex items-center justify-center bg-black/50 rounded-lg overflow-hidden">
                    <canvas id="annotation-canvas"></canvas>
                </div>
            </div>
        </div>

    </main>

    <!-- Tailwind config must come first so the rest of scripts can use it -->
    <script src="/js/config.js?v=2"></script>
    <!-- External libraries for Claude integration -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>

    <!-- Feature modules (must load before app.js which wires DOMContentLoaded) -->
    <script src="/js/auth.js"></script>
    <script src="/js/events.js"></script>
    <script src="/js/sync.js"></script>
    <script src="/js/settings.js"></script>
    <script src="/js/subpages.js"></script>
    <script src="/js/modals.js"></script>
    <script src="/js/activity.js"></script>
    <!-- Claude AI integration -->
    <script src="/js/screenshot.js"></script>
    <script src="/js/annotate.js"></script>
    <script src="/js/claude-chat.js"></script>
    <!-- app.js last — contains DOMContentLoaded init that calls all modules -->
    <script src="/js/app.js"></script>

</body>

</html>